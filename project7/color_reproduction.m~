%% Project 7: Color Reproduction. Team 14 (Jenee L & Justin P.)

%% Fetch ColorMunki XYZ and LAB data for color checker
%%Multiply munki XYZs by display model
colorMunkiData = importdata('munki_CC_XYZs_Labs.txt');
munkiXYZs = colorMunkiData(:,2:4);
munkiLABs = colorMunkiData(:,5:7);

%% Evaluate color error in model

dispModel = importdata('display_model.mat');

%Push through matrix model and conver to doubles
RGBCoords = derriveRGBs(munkiXYZs, dispModel);

%Scale RGB coordinates to a 0-100 range
RGBCoords = RGBCoords * (100/255);

dataSet = vertcat(RGBCoords, repmat(0,3,3), repmat(100,3,3));

dataReadings = [1:30; dataSet'];

%Write data to formatted ti1 file
writeTiFile('disp_model_test.ti1', dataReadings);

%% Uncalibrated color imaging workflow

%Fetch average RGBs of chart from project 5
% Using Readings from Jenee's 15" 2010 matte Macbook Pro

cam_RGBs = importdata('cam_rgbs.mat');

%Scale RGB values
cam_RGBs = double(cam_RGBs);
cam_RGBs = cam_RGBs .* (100/255);

%Construct matrix to write to ti1 file for colormunki
dataSet = [cam_RGBs, repmat(0,3,3),repmat(100,3,3)];
dataSet = [1:30;dataSet];

%Write data to formatted ti1 file
writeTiFile('workflow_test_uncal.ti1', dataReadings);

%% display relevant functions for report
dbtype('writeTiFile.m');
dbtype('writeTiFile.m');

